#!/usr/bin/env python3
"""
Script de migraci√≥n generado autom√°ticamente - 20250811_091016
Total de registros: 107
"""

from app import app, db, BaseConocimiento

def migrate_data():
    """Migra los datos reales a Render"""
    with app.app_context():
        print("üóÑÔ∏è Iniciando migraci√≥n de datos de JulioBot...")
        
        # Limpiar datos existentes de ejemplo (opcional)
        ejemplo_count = BaseConocimiento.query.filter(
            BaseConocimiento.consulta.in_(['linux', 'python', 'flask', 'render', 'chatbot'])
        ).count()
        if ejemplo_count > 0:
            BaseConocimiento.query.filter(
                BaseConocimiento.consulta.in_(['linux', 'python', 'flask', 'render', 'chatbot'])
            ).delete()
            print(f"üóëÔ∏è  Eliminados {ejemplo_count} datos de ejemplo")
        
        # Datos reales
        datos_reales = [{'consulta': 'crear un archivo linux', 'respuesta': 'dd if=/dev/zero of=/home/appweb/fichero bs=25M count=1'}, {'consulta': 'peso por carpeta', 'respuesta': 'du -h --max-depth=1 /var/log/backup'}, {'consulta': 'crear un archivo windows', 'respuesta': 'fsutil file createnew nombre_del_archivo 1073741824'}, {'consulta': 'carpetas compartidas en servidor windows', 'respuesta': 'net share'}, {'consulta': 'version tomcat conector', 'respuesta': 'strings /etc/httpd/modules/mod_jk.so |grep -i mod_jk/'}, {'consulta': 'puertos abiertos linux', 'respuesta': 'ss -tulpn'}, {'consulta': 'ver aplicativos que usan puerto', 'respuesta': 'lsof -i:25 (25 es el puerto)'}, {'consulta': 'validar config apache', 'respuesta': 'apachectl configtest'}, {'consulta': 'cambiar la ip del servidor', 'respuesta': 'vim /etc/sysconfig/network-scripts/ifcfg-ens192 ###### vim /etc/NetworkManager/system-connections/ens192.nmconnection'}, {'consulta': 'reinicio post pase cobralum', 'respuesta': 'Hebe (asadmin restart-domain http://hebe.pucp.edu.pe:8080/pucpws/procpago/PagosWS?wsdl), Gea (restartall  https://gea.pucp.edu.pe/pucp/vtaitnet/vtwpagcv/vtwpagcv?accion=Preparar&secuencia=235975&idsession=0000iZka4Ud0OEuT3XrbCKxd3Sn:188o8m64k ), plazacv (systemctl restart tomcat     https://campuspsm.pucp.edu.pe/pucp/alquileres/jsp/AccionIngresarPrincipal.jsp)'}, {'consulta': 'validar la fecha de caducidad de un certificado', 'respuesta': 'openssl x509 -enddate -noout -in "/etc/pki/tls/private/wildcard/ca.pem"'}, {'consulta': 'validar la conectividad con el protocolo openssl', 'respuesta': 'openssl s_client -connect tyche.pucp.edu.pe:443 -tls1_3'}, {'consulta': 'reemplaza palabra (sed)', 'respuesta': "sed -i 's/antigua/nueva/g' archivo.txt"}, {'consulta': 'copiar desde linea (sed)', 'respuesta': "sed -n '63000,101000p' file.txt > conl.txt"}, {'consulta': 'editar con interfaz gr√°fica la conexi√≥n de red', 'respuesta': 'nmtui'}, {'consulta': 'reinicio monitor', 'respuesta': 'sudo systemctl status monitor_log.service'}, {'consulta': 'desarrollador', 'respuesta': 'Fui desarrollado por Julio Jurado'}, {'consulta': 'versi√≥n de java a usar', 'respuesta': 'alternatives --config java'}, {'consulta': 'conocer el peso de todos los archivos cuyo nombre empiece con localhost', 'respuesta': "find . -type f -name 'localhost*' -exec du -ch {} + | grep total | awk '{print $1}'"}, {'consulta': 'c√≥digo fuente de calixto', 'respuesta': '/var/sys/agora/correo/'}, {'consulta': 'comparar 2 archivos en 2 servidores diferentes', 'respuesta': 'ssh appweb@tyche-ap1 "cat /etc/cas/config/application.properties" | diff /etc/cas/config/application.properties -'}, {'consulta': 'phpmyadmin (himeneo y agora)', 'respuesta': 'vim /etc/httpd/conf.d/phpMyAdmin.conf ####### service httpd restart'}, {'consulta': 'crear un programa como un servicio en redhat', 'respuesta': 'vim /etc/systemd/system/monitor_log.service'}, {'consulta': '', 'respuesta': ''}, {'consulta': 'agregar espacio moment√°neamente en campus virtual', 'respuesta': 'Organizaci√≥n > Servicios Inform√°ticos > Gesti√≥n Google PUCP > Registros > Registrar Excepci√≥n'}, {'consulta': 'portal himeneo', 'respuesta': 'himeneo.pucp.edu.pe/cafeteria/ventas  /var/sys/agora/cafeteria'}, {'consulta': 'proyecto borrado ws', 'respuesta': 'Servidor: 192.168.13.71 /opt/script_borrado_pucp'}, {'consulta': 'agrega una l√≠nea nueva al final de archivo (sed)', 'respuesta': "sed -i '$a\\postman6009877@emlmind.com REJECT' access_pucp"}, {'consulta': 'firma digital', 'respuesta': 'Se realiza con la clave privada luego en el destino se utiliza nuestra clave p√∫blica para validar la autenticidad'}, {'consulta': 'cifrado digital', 'respuesta': 'Se realiza con la llave p√∫blica del destino, luego en el destino se utiliza la clave privada propia para obtener el mensaje y validar la confidencialidad'}, {'consulta': 'certificado digital', 'respuesta': 'un certificado digital es similar a una llave, pero con m√°s informaci√≥n. En esencia, es un documento que contiene una clave p√∫blica y otros datos que permiten verificar la identidad de su propietario.   Contiene: Clave p√∫blica del titular. Datos de identidad (nombre, organizaci√≥n, dominio web, etc.). Nombre de la Autoridad Certificadora (CA) que lo emiti√≥. Fecha de emisi√≥n y expiraci√≥n. Firma digital de la CA (para verificar su autenticidad).'}, {'consulta': 'matricula idiomas', 'respuesta': 'https://ares.pucp.edu.pe/pucp/idiomas/idwclave/idwclave?accion=Login'}, {'consulta': 'error cas - shibboleth : no sessions supplied to back channel notification method', 'respuesta': 'Poner en el .json: "logoutType"        : "FRONT_CHANNEL", "logoutUrl"         : "https://tyche.pucp.edu.pe/pucp/logout",'}, {'consulta': 'cambiar para que dionisios apunte  epopeo', 'respuesta': 'C:\\WeSphere\\AppServer\\profiles\\AppSrv01\\installedApps\\dionisiosCell01\\intranetc1_war.ear.ear\\intranetc1.war\\pucp\\usuarios\\uswlogin\\jsp\\AccionCerrarSesion.jsp'}, {'consulta': 'comando powershell para buscar una cadena (pandora en este ejemplo) de forma recursiva', 'respuesta': 'Get-ChildItem -Path . -Recurse -File | Select-String -Pattern "pandora" | Select-Object -ExpandProperty Path | Get-Unique'}, {'consulta': 'sin permiso para la carpeta compartida windows para pegar archivos', 'respuesta': 'ir a la ruta compartida click derecho y en Security agregar el permiso Modify al grupo GAccesoDesarrollo o al grupo que pertenezca el usuario'}, {'consulta': 'agregar una ip al firewall para bloquearla', 'respuesta': 'firewall-cmd --permanent --zone=drop --add-source=52.86.208.153'}, {'consulta': 'validar que la ip est√© bloqueada en firewall', 'respuesta': 'firewall-cmd --list-sources --zone=drop'}, {'consulta': 'quitar una ip del firewall', 'respuesta': 'firewall-cmd --permanent --zone=drop --remove-source=XXX.XXX.XXX.XXX'}, {'consulta': 'recargar el firewall', 'respuesta': 'firewall-cmd --reload'}, {'consulta': 'listar el firewall', 'respuesta': 'firewall-cmd --list-all'}, {'consulta': 'crear un archivo en powershell', 'respuesta': 'New-Item -Path . -Name "Dockerfile" -ItemType "File"'}, {'consulta': 'listar los procesos de docker corriendo', 'respuesta': 'docker ps -a'}, {'consulta': 'detener un proceso de docker', 'respuesta': 'docker stop <name_process>'}, {'consulta': 'borrar un proceso de docker', 'respuesta': 'Primero detenerlo con docker stop y luego docker rm <docker_name>'}, {'consulta': 'ejecutar un proceso docker existente en docker-hub', 'respuesta': 'docker run hello-world'}, {'consulta': 'construir una imagen en docker', 'respuesta': 'Luego de haber creado el dockerFile se debe ejecutar docker build -t (Nombre de la imagen) . (Lugar donde est√° el DockerFile)'}, {'consulta': 'una vez creado el contenedor docker con build se ejecuta con run', 'respuesta': 'docker run mi-imagen-python entonces reci√©n se ver√° en el docker ps -a'}, {'consulta': 'ejecutar un contenedor que tiene una variable de entorno llamada mensaje en su dockerfile', 'respuesta': 'docker run -e MENSAJE="Hola, Docker !" mi-imagen-python'}, {'consulta': 'docker volumenes', 'respuesta': 'Se usan para que se monte un directorio completo dentro de la aplicaci√≥n de docker con el siguiente comando donde ${pwd} es la ruta del proyecto y :/app es el nombre de la carpeta montada docker run -v ${PWD}:/app mi-imagen-python'}, {'consulta': 'ejecutar un contenedor con volumen y permanezca arriba', 'respuesta': 'docker run -d -v ${PWD}:/app mi-imagen-python tail -f /dev/null'}, {'consulta': 'tail -f pero en power shell', 'respuesta': 'Get-Content nombre_del_archivo -Wait -Tail 20'}, {'consulta': 'instalar sqlplus', 'respuesta': 'instalar estas dos bibliotecas: oracle-instantclient12.2-basic-12.2.0.1.0-1.x86_64.rpm y oracle-instantclient12.2-sqlplus-12.2.0.1.0-1.x86_64.rpm luego si falta una librer√≠a instalarla en mi caso faltaba ---- dnf install libnsl'}, {'consulta': 'sqlplus est√° instalado en tyche-ap1', 'respuesta': 'a'}, {'consulta': 'nuevo server windows sin conexi√≥n rdp', 'respuesta': '1.- win + R --> sysdm.cpl / Remoto / Permitir Conexiones remotas a este equipo. 2.- win + R --> firewall.cpl  / Allow an app or  feature thorugh Windows Firewall  / Remote Desktop (Activar las casillas))   3.- Permitir el  Ping : win + R --> wf.msc / Reglas de entrada / File and Printer Sharing (Echo Request - ICMPv4- In)'}, {'consulta': 'cambiar pass usuario administrator windows server', 'respuesta': 'Si estamos dentro de una m√°quina virtual hacer ctrl + alt + END (Fn + flecha a la derecha) elegir cambiar contrase√±a'}, {'consulta': 'git clone', 'respuesta': 'git clone --branch dev --single-branch ssh://git@gitlab-dti.pucp.edu.pe:2289/aplicaciones-academicas/json-cas6.git pucp-services --> clonamos el c√≥digo (no hace falta poner un git init porque git ya lo hace con el clone) le ponemos --branch dev para que clone directamente desde dev'}, {'consulta': 'git branch', 'respuesta': 'git branch -a --> validamos que ramas hay disponibles, previamente hemos creado la rama en el gitlab'}, {'consulta': 'git fetch', 'respuesta': 'git fetch --> actualizamos las ramas existentes para poder hacer el checkout'}, {'consulta': 'git checkput', 'respuesta': 'git checkout dev --> Cambiamos a la rama dev'}, {'consulta': 'git add', 'respuesta': 'git add . --> subiendo todo a la memoria ponerlo listo para hacer el commit'}, {'consulta': 'git commit', 'respuesta': 'git commit -m "Mensaje descriptivo" --> commit'}, {'consulta': 'git push', 'respuesta': 'git push --> subiendo al gitlab'}, {'consulta': 'entrar a la memcached', 'respuesta': 'telnet localhost 11211 (desde tyche ap1 o un servidor que tenga instalado el memcached)'}, {'consulta': 'validar los slabs de la memcached', 'respuesta': 'stats items'}, {'consulta': 'entrar en cada slab (en este caso slab 20) para ver sus ids', 'respuesta': 'stats cachedump 20 10'}, {'consulta': 'ver el contenido del id del slab de la memcached', 'respuesta': 'get <ID>'}, {'consulta': 'listar los items dentro de un slab de la memcached', 'respuesta': 'stats cachedump 21 13 <20=ID DE SLAB><13=N√∫mero de l√≠neas m√°x en el resultado>'}, {'consulta': 'revisar con mailq la lista de correos y se pueden borrar en', 'respuesta': '/var/spool/borracola.sh <nombre del remitente>'}, {'consulta': 'versi√≥n de tomcat', 'respuesta': 'cd -- "$(dirname "$(find / -type f -name catalina.jar | head -1)")" ;java -cp catalina.jar org.apache.catalina.util.ServerInfo    o      /usr/sbin/tomcat version'}, {'consulta': 'ver el contenido de un correo en postfix', 'respuesta': 'Primero obtener la lista de dominios que tienen correos encolados ejecutando desde /root/scripts/correos_encolados.sh una vez identificado el dominio se ejecuta un mailq | grep nombre_del_correo, luego elegimos el ID que se quiera ver y con el comando postcat de la siguiente manera : postcat -q ID_ELEGIDO'}, {'consulta': 'si se encolan lo correos', 'respuesta': 'Primero revisar con mailq los remitentes que no sean tipo spam (MAIL DEMON o xxxxx o as√≠) se pueden borrar estos correos con el comando /var/spool/borracol <NOMBRE REMITENTE> y luego validar la cola con /home/appweb/correos_encolados.sh y forzar con /usr/sbin/postqueue -f'}, {'consulta': 'solicitan poder compartir el calendario con cuenta externa', 'respuesta': 'Se debe a agregar el correo pucp mediante la WorkSpace al grupo calendario-externo@pucp.edu.pe'}, {'consulta': 'borrar todos los correos que est√°n encolados cuyo remitente empiece con x-', 'respuesta': "postqueue -p | awk '$7 ~ /^x-/ {print $1}' | tr -d '*' | xargs -I {} postsuper -d {}  -----> tr -d '*' : Elimina cualquier * que pueda estar presente en los IDs  ------->   xargs -I {} postsuper -d {}    :     En lugar de pasar todos los IDs de golpe, los procesa uno por uno, evitando errores"}, {'consulta': 'bloquear un dominio en la workspace', 'respuesta': 'Apps >> Google Workspace >> Gmail >> Spam, phishing y software malicioso >> Remitentes bloqueados >> Editar >> Crear o Editar una lista existente >> Editar >> Agregar Direcci√≥n >> Guardar.'}, {'consulta': 'servidor tomcat apunte a una base de datos', 'respuesta': 'En el archivo /etc/tomcat/context.xml agregar la referencia a la conexi√≥n ubicada en /etc/tomcat/server.xml --> c√≥mo ejemplo se puede tomar el servidor cyrene con rhel9'}, {'consulta': 'falla asteria - asbanc', 'respuesta': 'Validar en asteria en el Event Viewer los errores puede ser un error de conexi√≥n con el usuario sa a la base de datos, se debe reiniciar el equipo para que Asbanc entre a revisar.'}, {'consulta': 'ejecutar tomcat 10 sin modificar las variables de entorno del 9', 'respuesta': 'Establecer las VdeE temporalmente con: $env:CATALINA_HOME="D:\\apache-tomcat-10.1.39" $env:CATALINA_BASE="D:\\apache-tomcat-10.1.39"'}, {'consulta': 'entrar al manager app de tomcat 10', 'respuesta': 'Una vez dentro de localhost:8080 (o el puerto que se haya configurado en el server.xml) boton manager app te pedir√° el usuario y pass configurado en  tomca-user.xml en este archivo s√≥lo se configura el usuario y password con el rol de esta manera: <user username="tomcat" password="tomcat" roles="manager-gui"/> el rol ya viene configurado en el archivo web.xml del webapps/manager/WEB-INF/web.xml --> le tuve que poner un usuario y pass diferente a otros roles'}, {'consulta': 'descargar el cas 7.2 desde el github en su versi√≥n overlay (viene una versi√≥n lista para editar con la carpeta src/main)', 'respuesta': 'git clone -b 7.2 https://github.com/apereo/cas-overlay-template.git --> el 7.2 es el branch que est√° en el git hub https://github.com/apereo/cas-overlay-template/tree/7.2#'}, {'consulta': 'leer un archivo .so', 'respuesta': 'sudo yum install -y binutils   / strings /etc/httpd/modules/mod_jk.so |grep -i mod_jk/    -->para saber la versi√≥n del connector'}, {'consulta': 'servidor de pruebas de google (comando gam)', 'respuesta': 'Servidor 192.168.13.70 y 71 ruta: /opt/gam/gamadv-xtd3/ y luego ejecutar el comando https://sites.google.com/view/gam--commands/people/groups'}, {'consulta': 'comando para listar los miembros de los grupos', 'respuesta': './gam print group-members group_ns dti-it-seguridad@pucp.edu.pe'}, {'consulta': 'agregar un correo como manager a una lista de grupos en csv (gam) el archivo tiene que tener como cabecera la palabra email (~email)', 'respuesta': './gam csv gruposdti.csv gam update group ~email add manager direccion-dti@pucp.edu.pe'}, {'consulta': 'listar miembros de un grupo (comando gam)', 'respuesta': './gam print group-members group_ns dti-it-seguridad@pucp.edu.pe'}, {'consulta': 'qu√© son los slabs de la memcached ?', 'respuesta': 'Un slab en Memcached es un bloque de memoria donde se almacenan objetos del mismo tama√±o. Memcached organiza la memoria en slabs para optimizar la velocidad y evitar fragmentaci√≥n.  Cuando un nuevo dato (por ejemplo, un TGT de CAS) se guarda en Memcached, se asigna a un slab seg√∫n su tama√±o. Cada slab tiene un tama√±o de bloque fijo, y Memcached decide en cu√°l almacenarlo dependiendo del espacio que necesita.'}, {'consulta': 'cambiar en el cas la ruta de olvid√© mi contrase√±a :', 'respuesta': '/usr/share/tomcat/webapps/pucp/WEB-INF/classes/static/c3/js/AccionIngresarOlvidoContrasena.js'}, {'consulta': 'validar en los dns internos', 'respuesta': 'nslookup zetes.pucp.edu.pe castor.pucp.edu.pe'}, {'consulta': 'validar en los dns externos', 'respuesta': 'nslookup zetes.pucp.edu.pe dns2.pucp.edu.pe'}, {'consulta': 'generar una clave p√∫blica y privada ssh en linux', 'respuesta': 'ssh-keygen (crea las claves en ~/.ssh/)'}, {'consulta': 'copiar la clave p√∫blica ssh en el servidor remoto', 'respuesta': 'ssh-copy-id appweb@tyche-ap2 (esto copiar√° la clave p√∫blica en el servidor tyche-ap2 en la ruta ~/ssh/autorized_keys)'}, {'consulta': 'En el caso que tomcat haya sido instalado desde la p√°gina de tomcat se modifica el tomcat.service sino buscar el tomcat.conf', 'respuesta': 'Primero buscar d√≥nde est√° instalado si es que no est√° en las variables de entorno (si no funciona utilizando simplemente jcmd)  con el siguiente comando: find / -type f -name jcmd 2>/dev/null'}, {'consulta': 'luego para ejecutar el comando head memory jcmd java ya sabiendo el pid que nos di√≥ la consulta del jcmd', 'respuesta': 'runuser -u tomcat -- /usr/lib/jvm/java-11-openjdk-11.0.23.0.9-3.el9.x86_64/bin/jcmd 2859876 VM.flags'}, {'consulta': 'el segundo paso es ejecutar el comando con la ruta completa para saber la memory heap java para saber el pid', 'respuesta': '/usr/lib/jvm/java-17-openjdk-17.0.14.0.7-2.el9.x86_64/bin/jcmd   (o cual haya salido en el comando anterior)'}, {'consulta': 'buscar el tomcat.service para agregar los cambios de la memory heap java', 'respuesta': 'find / -iname "tomcat.service" *'}, {'consulta': 'para agregar la memory heap java en las instalaciones de tomcat que son por dnf o yum se debe modificar en el archivo que posea la variable java_opts en uno de los siguientes archivos /etc/tomcat/tomcat.conf o /etc/sysconfig/tomcat modificandolo as√≠:', 'respuesta': 'JAVA_OPTS="-Xms512m -Xmx2048m -Djavax.sql.DataSource.Factory=org.apache.commons.dbcp.BasicDataSourceFactory"'}, {'consulta': 'imprimir todos los grupos (comando gam)', 'respuesta': './gam print groups > gruposdti2.csv'}, {'consulta': 'cambios para compilar con java 8 consultasingresoscampus (1)', 'respuesta': 'en el archivo nbproject/project.properties #platform.active=JDK_1.6 platform.active=default_platform platforms.default_platform.home=/usr/lib/jvm/java-1.8.0-openjdk javac.source=1.8 javac.target=1.8'}, {'consulta': 'cambios para compilar con java 8 consultasingresoscampus (2)', 'respuesta': 'Instalar ant java-1.8.0-openjdk-devel'}, {'consulta': 'cambiar ambiente en rigel a preproducci√≥n', 'respuesta': 'Abrir la consola >> Resources >> JDBC >> Data sources >> DataSource Rigel >> elegir preproduccion en Component-managed y Container-managed >> Cambiar la URL a jdbc:oracle:oci@preproduccion >> Cambiar EL SSO en el archivo web.xml (C:\\WebSphere\\AppServer\\profiles\\AppSrv01\\installedApps\\rigelCell01\\intranetc1_war.ear.ear\\intranetc1.war\\WEB-INF) pasar de pandora.pucp.edu.pe a tyche.pucp.edu.pe>> Reiniciar con restartall desde powershell'}, {'consulta': 'cambiar ambiente de rigel a producci√≥n', 'respuesta': 'Abrir la consola >> Resources >> JDBC >> Data sources >> DataSource Rigel >> elegir produccion en Component-managed y Container-managed >> Cambiar la URL a jdbc:oracle:oci@pucpurano >> Cambiar EL SSO en el archivo web.xml (C:\\WebSphere\\AppServer\\profiles\\AppSrv01\\installedApps\\rigelCell01\\intranetc1_war.ear.ear\\intranetc1.war\\WEB-INF) pasar de tyche.pucp.edu.pe a pandora.pucp.edu.pe>> Reiniciar con restartall desde powershell'}, {'consulta': 'compilar con java 1.8 con ant consultasingresoscampus (3)', 'respuesta': 'ant dist'}, {'consulta': 'ver el hostname en un servidor linux', 'respuesta': 'hostnamectl'}, {'consulta': 'cambiar el hostname en un servidor linux', 'respuesta': 'hostnamectl set-hostname NUEVO_NOMBRE'}, {'consulta': 'pase en dtibackenddti', 'respuesta': 'Bajar el war desde el gitlab Aplicaciones administrativas GestionDatosEstudiantiles Pipelines Build /Pipelines click en la flechita hacia abajo,,,en el servidor la ruta/opt/IBM/WebSphere/Liberty/usr/servers/server1/dropins/, no hace falta reiniciar nada'}, {'consulta': 'validar el registro de la llave dkim el servidor dns(para este ejemplo el registro llamado localprep para el dominio pucpprep.edu.pe)', 'respuesta': 'nslookup -type=TXT localprep._domainkey.pucpprep.edu.pe'}, {'consulta': 'copiar un google drive con el comando gam', 'respuesta': 'Se debe ingresar al servidor 192.168.13.70 y ejecutar en la ruta: /opt/gam/gamadv-xtd3/ el siguiente comando:  ./gam user griveram@pucp.pe copy drivefile root recursive teamdriveparent "Unidad Compartida Test" mergewithparent true verifyorganizer false  ==>  Para esto se ha creado una Unidad Compartida llamada "Unidad Compartida Test" y la usuaria a la cual se le va a copiar la informaci√≥n tiene que tener permiso de colaboradora por lo menos en la UC'}]
        
        print(f"üìä Migrando {len(datos_reales)} registros...")
        
        migrados = 0
        actualizados = 0
        
        for i, dato in enumerate(datos_reales, 1):
            if not dato["consulta"] or not dato["respuesta"]:
                continue
                
            # Verificar si ya existe
            existe = BaseConocimiento.query.filter_by(consulta=dato["consulta"]).first()
            if not existe:
                nuevo_registro = BaseConocimiento(
                    consulta=dato["consulta"],
                    respuesta=dato["respuesta"]
                )
                db.session.add(nuevo_registro)
                print(f"‚úÖ {i}. Agregado: {dato['consulta'][:50]}...")
                migrados += 1
            else:
                # Actualizar respuesta si es diferente
                if existe.respuesta != dato["respuesta"]:
                    existe.respuesta = dato["respuesta"]
                    print(f"üîÑ {i}. Actualizado: {dato['consulta'][:50]}...")
                    actualizados += 1
                else:
                    print(f"‚ö†Ô∏è  {i}. Ya existe: {dato['consulta'][:50]}...")
        
        try:
            db.session.commit()
            total_final = BaseConocimiento.query.count()
            print(f"üéâ Migraci√≥n completada!")
            print(f"   ‚Ä¢ Registros agregados: {migrados}")
            print(f"   ‚Ä¢ Registros actualizados: {actualizados}")
            print(f"   ‚Ä¢ Total en base de datos: {total_final}")
        except Exception as e:
            db.session.rollback()
            print(f"‚ùå Error en la migraci√≥n: {e}")

if __name__ == "__main__":
    migrate_data()
